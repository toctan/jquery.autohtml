(function(){var a,b;a=jQuery,b=function(){function a(a){this.html=a}return a.prototype.set_html=function(a){return this.html=a.replace("<p></p>","").replace("<p><br>","<p>").replace("<br></p>","</p>"),this},a.prototype.all=function(){return this.simpleFormat().mention().image().twitter().youtube().vimeo().youku().tudou().link().html},a.prototype.simpleFormat=function(){return this.set_html(this.html.replace(/\n{2,}/g,"</p><p>").replace(/\n/g,"<br>").replace(/^(<p>)*/,"<p>").replace(/(<\/p>)*$/,"</p>"))},a.prototype.mention=function(){var a;return a=/@\w+/g,this.set_html(this.html.replace(a,function(a){return a.length>20?a:'<a href="/'+a+'">'+a+"</a>"}))},a.prototype.link=function(){var a;return a=/((https?|ftp):\/\/[\w?=&.\/-;#~%-]+(?![\w\s?&.\/;#~%"=-]*>))/gi,this.set_html(this.html.replace(a,'<a href="$1">$1</a>'))},a.prototype.image=function(){var a;return a=/https?:\/\/.+\.(jpg|jpeg|bmp|gif|png)(\?\S+)?/gi,this.set_html(this.html.replace(a,'<img src="$&" alt>'))},a.prototype.twitter=function(){var a;return a=/https:\/\/twitter\.com\/[A-Za-z0-9_]{1,15}\/status(es)?\/\d+/gi,this.set_html(this.html.replace(a,'</p><blockquote class="twitter-tweet"><a href="$&"></a></blockquote><script async src="//platform.twitter.com/widgets.js"></script><p>'))},a.prototype.youtube=function(){var a;return a=/https?:\/\/(www.)?(youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_-]*)(\&\S+)?[\w?=&.\/-;#~%]*/gi,this.set_html(this.html.replace(a,'</p><div class="video-wrapper"><iframe width="640" height="360" src="//www.youtube.com/embed/$3" frameborder="0" allowfullscreen></iframe></div><p>'))},a.prototype.vimeo=function(){var a;return a=/https?:\/\/(www.)?vimeo\.com\/(\w+\/)*(\d+)((\?|#)\S+)?/gi,this.set_html(this.html.replace(a,'</p><div class="video-wrapper"><iframe width="640" height="360" src="//player.vimeo.com/video/$3" frameborder="0" allowfullscreen></iframe></div><p>'))},a.prototype.youku=function(){var a;return a=/http:\/\/v.youku.com\/v_show\/id_(\w+)(\.)?[\w?=&.\/-;#~%]*/gi,this.set_html(this.html.replace(a,'</p><div class="video-wrapper"><iframe width="640" height="360" src="//player.youku.com/embed/$1" frameborder="0" allowfullscreen></iframe></div><p>'))},a.prototype.tudou=function(){var a;return a=/https?:\/\/(www.)?tudou\.com\/(\w)(istplay|lbumplay|iew)\/([\w-]+)[\w?=&.\/-;#~%]*/gi,this.set_html(this.html.replace(a,'</p><div class="video-wrapper"><embed width="640" height="360" src="//www.tudou.com/$2/$4" type="application/x-shockwave-flash" allowfullscreen allowscriptaccess="always" wmode="opaque"></embed></div><p>'))},a}(),a.autohtml=function(a){return""===a?a:new b(a).all()},a.fn.autohtml=function(){return this.each(function(){return a(this).html(new b(a(this).html()).all())})}}).call(this);